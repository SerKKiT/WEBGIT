# ðŸ“‹ **ENTERPRISE STREAMING PLATFORM - COMPLETE CURL TEST COMMANDS**

**Version:** Production Ready v2.0  
**Date:** September 26, 2025  
**Status:** Enterprise Grade - Netflix/Twitch Competition Ready

***

## ðŸš€ **QUICK START - BASIC FUNCTIONALITY TEST**

```bash
# Health check all services
curl -X GET "http://localhost/health"
curl -X GET "http://localhost/api/auth/health"
curl -X GET "http://localhost/api/main/health"
curl -X GET "http://localhost/api/stream/health"
curl -X GET "http://localhost/api/vod/health"

# Register user and get token
curl -X POST "http://localhost/api/auth/register" \
  -H "Content-Type: application/json" \
  -d '{"username":"testuser","email":"test@example.com","password":"test123456","role":"streamer"}'

# Create and start stream (replace TOKEN with actual token)
export TOKEN="your_jwt_token_here"
curl -X POST "http://localhost/api/streams" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"name":"Test Stream","title":"My First Stream"}'

# Start streaming (replace STREAM_ID with actual stream ID)
export STREAM_ID="your_stream_id_here"
curl -X POST "http://localhost/api/streams/$STREAM_ID/start" \
  -H "Authorization: Bearer $TOKEN"
```

***

## ðŸ” **AUTHENTICATION & USER MANAGEMENT**

### **User Registration**
```bash
# Register new streamer
curl -X POST "http://localhost/api/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "mystreamer",
    "email": "streamer@example.com", 
    "password": "securepass123",
    "role": "streamer"
  }'

# Register viewer  
curl -X POST "http://localhost/api/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "viewer1",
    "email": "viewer@example.com",
    "password": "viewpass123", 
    "role": "viewer"
  }'

# Register admin
curl -X POST "http://localhost/api/auth/register" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "admin",
    "email": "admin@company.com",
    "password": "adminpass123",
    "role": "admin" 
  }'
```

### **User Login**
```bash
# Login and get JWT token
curl -X POST "http://localhost/api/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "username": "mystreamer",
    "password": "securepass123"
  }'

# Login with email
curl -X POST "http://localhost/api/auth/login" \
  -H "Content-Type: application/json" \
  -d '{
    "email": "streamer@example.com",
    "password": "securepass123"
  }'
```

### **Token Operations**
```bash
# Validate token
curl -X POST "http://localhost/api/auth/validate-token" \
  -H "Content-Type: application/json" \
  -d '{"token": "your_jwt_token_here"}'

# Refresh token
curl -X POST "http://localhost/api/auth/refresh" \
  -H "Authorization: Bearer your_jwt_token_here"

# Get user profile
curl -X GET "http://localhost/api/auth/profile" \
  -H "Authorization: Bearer your_jwt_token_here"
```

***

## ðŸŽ¥ **STREAMING OPERATIONS**

### **Stream Creation**
```bash
# Create basic stream
curl -X POST "http://localhost/api/streams" \
  -H "Authorization: Bearer your_jwt_token_here" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "My Live Stream",
    "title": "Amazing Content Here"
  }'

# Create stream with description
curl -X POST "http://localhost/api/streams" \
  -H "Authorization: Bearer your_jwt_token_here" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Gaming Stream",
    "title": "Live Gaming Session - Fortnite",
    "description": "Professional gaming stream with commentary",
    "category": "gaming"
  }'

# Create private stream
curl -X POST "http://localhost/api/streams" \
  -H "Authorization: Bearer your_jwt_token_here" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Private Event",
    "title": "Company Meeting Stream", 
    "private": true,
    "password": "meeting123"
  }'
```

### **Stream Management**
```bash
# Start stream
curl -X POST "http://localhost/api/streams/your_stream_id/start" \
  -H "Authorization: Bearer your_jwt_token_here"

# Stop stream  
curl -X POST "http://localhost/api/streams/your_stream_id/stop" \
  -H "Authorization: Bearer your_jwt_token_here"

# Get stream info
curl -X GET "http://localhost/api/streams/your_stream_id" \
  -H "Authorization: Bearer your_jwt_token_here"

# Get my streams
curl -X GET "http://localhost/api/streams/my" \
  -H "Authorization: Bearer your_jwt_token_here"

# Get public live streams
curl -X GET "http://localhost/api/streams"

# Update stream settings
curl -X PUT "http://localhost/api/streams/your_stream_id" \
  -H "Authorization: Bearer your_jwt_token_here" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "Updated Stream Title",
    "description": "New description"
  }'
```

***

## ðŸ“‹ **TASK MANAGEMENT (Legacy System)**

### **Task Operations**
```bash
# Get all tasks
curl -X GET "http://localhost/tasks"

# Get tasks for specific stream
curl -X GET "http://localhost/tasks?stream_id=your_stream_id"

# Create task (requires name field)
curl -X POST "http://localhost/tasks" \
  -H "Content-Type: application/json" \
  -d '{
    "name": "Processing Task",
    "stream_id": "your_stream_id",
    "status": "pending"
  }'

# Update task status
curl -X PUT "http://localhost/tasks?id=1" \
  -H "Content-Type: application/json" \
  -d '{"status": "running"}'

# Delete task (uses query parameter)
curl -X DELETE "http://localhost/tasks?id=1"

# Get active tasks only
curl -X GET "http://localhost/tasks/active"

# Update task status by stream ID
curl -X PUT "http://localhost/tasks/update_status_by_stream" \
  -H "Content-Type: application/json" \
  -d '{
    "stream_id": "your_stream_id",
    "status": "completed"
  }'
```

***

## ðŸ“¹ **VOD & RECORDING MANAGEMENT**

### **Recording Operations**
```bash
# Get recording info
curl -X GET "http://localhost/api/recordings/your_stream_id" \
  -H "Authorization: Bearer your_jwt_token_here"

# Get all recordings for user
curl -X GET "http://localhost/api/recordings" \
  -H "Authorization: Bearer your_jwt_token_here"

# Get recording thumbnail
curl -X GET "http://localhost/api/recordings/your_stream_id/thumbnail" \
  -H "Authorization: Bearer your_jwt_token_here" \
  -o "thumbnail.jpg"

# Download recording
curl -X GET "http://localhost/api/recordings/your_stream_id/download" \
  -H "Authorization: Bearer your_jwt_token_here" \
  -o "recording.mp4"

# Get recording stats
curl -X GET "http://localhost/api/recordings/your_stream_id/stats" \
  -H "Authorization: Bearer your_jwt_token_here"

# Update recording metadata
curl -X PUT "http://localhost/api/recordings/your_stream_id" \
  -H "Authorization: Bearer your_jwt_token_here" \
  -H "Content-Type: application/json" \
  -d '{
    "title": "My Amazing Recording",
    "description": "Great content recorded live"
  }'
```

***

## ðŸ”— **HLS & STREAMING URLS**

### **HLS Playlist Access**
```bash
# Get HLS master playlist
curl -X GET "http://localhost/hls/your_stream_id/stream.m3u8"

# Get specific quality playlist
curl -X GET "http://localhost/hls/your_stream_id/720p/stream.m3u8"
curl -X GET "http://localhost/hls/your_stream_id/480p/stream.m3u8"
curl -X GET "http://localhost/hls/your_stream_id/360p/stream.m3u8"

# Get segment files
curl -X GET "http://localhost/hls/your_stream_id/segment_001.ts"
curl -X GET "http://localhost/hls/your_stream_id/720p/segment_001.ts"

# Check playlist availability
curl -I "http://localhost/hls/your_stream_id/stream.m3u8"
```

### **SRT Connection Info**
```bash
# SRT URLs are returned when starting stream:
# srt://localhost:10000?streamid=your_stream_id

# Test SRT endpoint availability (if implemented)
curl -X GET "http://localhost/api/srt/status/your_stream_id"
```

***

## ðŸ” **MONITORING & ANALYTICS**

### **Health Checks**
```bash
# Gateway health
curl -X GET "http://localhost/health"

# Service-specific health
curl -X GET "http://localhost/api/auth/health"
curl -X GET "http://localhost/api/main/health" 
curl -X GET "http://localhost/api/stream/health"
curl -X GET "http://localhost/api/vod/health"

# Detailed system status
curl -X GET "http://localhost/api/system/status" \
  -H "Authorization: Bearer admin_jwt_token"
```

### **Analytics & Metrics**
```bash
# Stream analytics
curl -X GET "http://localhost/api/analytics/streams/your_stream_id" \
  -H "Authorization: Bearer your_jwt_token_here"

# User analytics  
curl -X GET "http://localhost/api/analytics/user" \
  -H "Authorization: Bearer your_jwt_token_here"

# System metrics (admin only)
curl -X GET "http://localhost/api/metrics/system" \
  -H "Authorization: Bearer admin_jwt_token"

# Viewer statistics
curl -X GET "http://localhost/api/analytics/viewers/your_stream_id"
```

***

## ðŸ§ª **TESTING & DEVELOPMENT**

### **Development Endpoints**
```bash
# Debug migration status
curl -X GET "http://localhost/debug/migrations"

# Test database connection
curl -X GET "http://localhost/api/debug/db-test" \
  -H "Authorization: Bearer admin_jwt_token"

# Generate test data
curl -X POST "http://localhost/api/debug/generate-test-data" \
  -H "Authorization: Bearer admin_jwt_token" \
  -H "Content-Type: application/json" \
  -d '{"users": 5, "streams": 10}'

# Clear test data
curl -X DELETE "http://localhost/api/debug/clear-test-data" \
  -H "Authorization: Bearer admin_jwt_token"
```

### **Load Testing**
```bash
# Stress test endpoints
for i in {1..100}; do
  curl -X GET "http://localhost/health" &
done
wait

# Concurrent stream creation test
for i in {1..10}; do
  curl -X POST "http://localhost/api/streams" \
    -H "Authorization: Bearer your_jwt_token_here" \
    -H "Content-Type: application/json" \
    -d "{\"name\":\"Test Stream $i\",\"title\":\"Load Test $i\"}" &
done
wait
```

***

## ðŸ§¹ **CLEANUP & MAINTENANCE**

### **Resource Cleanup**
```bash
# Delete specific task
curl -X DELETE "http://localhost/tasks?id=1"

# Bulk task cleanup (IDs 1-50)
for i in {1..50}; do
  curl -X DELETE "http://localhost/tasks?id=$i"
done

# Update all tasks for stream to deleted status
curl -X PUT "http://localhost/tasks/update_status_by_stream" \
  -H "Content-Type: application/json" \
  -d '{
    "stream_id": "your_stream_id",
    "status": "deleted"
  }'

# Admin cleanup (if implemented)
curl -X DELETE "http://localhost/tasks/cleanup" \
  -H "Authorization: Bearer admin_jwt_token"
```

### **Database Cleanup** 
```bash
# These would be direct database commands:
# docker exec postgres-db psql -U streaming_user -d streaming_db -c "DELETE FROM tasks;"
# docker exec postgres-db psql -U streaming_user -d streaming_db -c "DELETE FROM streams WHERE status = 'stopped';"
```

***

## ðŸ”’ **SECURITY TESTING**

### **Authentication Tests**
```bash
# Test invalid token
curl -X POST "http://localhost/api/streams" \
  -H "Authorization: Bearer invalid_token_123" \
  -H "Content-Type: application/json" \
  -d '{"name":"Security Test","title":"Should Fail"}'

# Test expired token
curl -X GET "http://localhost/api/streams/my" \
  -H "Authorization: Bearer expired_token_here"

# Test unauthorized access
curl -X GET "http://localhost/api/streams/private_stream_id"

# Test role-based access
curl -X POST "http://localhost/api/streams" \
  -H "Authorization: Bearer viewer_jwt_token" \
  -H "Content-Type: application/json" \
  -d '{"name":"Viewer Test","title":"Should Fail - No Streamer Role"}'
```

### **CORS Testing**
```bash
# Test CORS preflight
curl -X OPTIONS "http://localhost/api/streams" \
  -H "Origin: http://localhost:3000" \
  -H "Access-Control-Request-Method: POST" \
  -H "Access-Control-Request-Headers: Content-Type,Authorization"

# Test cross-origin request
curl -X GET "http://localhost/api/streams" \
  -H "Origin: http://example.com"
```

***

## ðŸ“Š **COMPLETE PRODUCTION TEST SEQUENCE**

### **Full Lifecycle Test**
```bash
#!/bin/bash
# Complete production test sequence

# 1. Health checks
echo "=== Health Checks ==="
curl -X GET "http://localhost/health"
curl -X GET "http://localhost/api/auth/health"
curl -X GET "http://localhost/api/main/health"
curl -X GET "http://localhost/api/stream/health"
curl -X GET "http://localhost/api/vod/health"

# 2. User registration
echo "=== User Registration ==="
RESPONSE=$(curl -s -X POST "http://localhost/api/auth/register" \
  -H "Content-Type: application/json" \
  -d '{"username":"testuser'$RANDOM'","email":"test'$RANDOM'@example.com","password":"test123456","role":"streamer"}')

TOKEN=$(echo $RESPONSE | jq -r '.access_token')
USER_ID=$(echo $RESPONSE | jq -r '.user.id')

echo "Token: $TOKEN"
echo "User ID: $USER_ID"

# 3. Stream creation
echo "=== Stream Creation ==="
STREAM_RESPONSE=$(curl -s -X POST "http://localhost/api/streams" \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{"name":"Production Test Stream","title":"Full Production Test"}')

STREAM_ID=$(echo $STREAM_RESPONSE | jq -r '.stream_id')
echo "Stream ID: $STREAM_ID"

# 4. Stream start
echo "=== Stream Start ==="
START_RESPONSE=$(curl -s -X POST "http://localhost/api/streams/$STREAM_ID/start" \
  -H "Authorization: Bearer $TOKEN")

SRT_URL=$(echo $START_RESPONSE | jq -r '.srt_endpoint')
HLS_URL=$(echo $START_RESPONSE | jq -r '.hls_url')

echo "SRT URL: $SRT_URL"
echo "HLS URL: $HLS_URL"

# 5. Wait and stop stream
echo "=== Waiting 30 seconds then stopping stream ==="
sleep 30

curl -s -X POST "http://localhost/api/streams/$STREAM_ID/stop" \
  -H "Authorization: Bearer $TOKEN"

# 6. Check VOD processing
echo "=== VOD Processing Check ==="
sleep 60

VOD_RESPONSE=$(curl -s -X GET "http://localhost/api/recordings/$STREAM_ID" \
  -H "Authorization: Bearer $TOKEN")

echo "VOD Status: $(echo $VOD_RESPONSE | jq -r '.status')"
echo "Duration: $(echo $VOD_RESPONSE | jq -r '.duration_seconds') seconds"
echo "File Size: $(echo $VOD_RESPONSE | jq -r '.file_size_bytes') bytes"

# 7. Cleanup
echo "=== Cleanup ==="
for i in {1..20}; do
  curl -s -X DELETE "http://localhost/tasks?id=$i" > /dev/null
done

echo "=== Test Complete ==="
```

***

## ðŸ’¡ **TIPS & BEST PRACTICES**

### **Environment Variables**
```bash
# Set common variables
export PLATFORM_URL="http://localhost"
export AUTH_TOKEN="your_jwt_token_here"
export STREAM_ID="your_stream_id_here"

# Use in commands
curl -X GET "$PLATFORM_URL/api/streams/$STREAM_ID" \
  -H "Authorization: Bearer $AUTH_TOKEN"
```

### **Windows Batch Version**
```batch
REM Windows equivalent commands
set PLATFORM_URL=http://localhost
set AUTH_TOKEN=your_jwt_token_here

curl -X GET "%PLATFORM_URL%/health"
curl -X POST "%PLATFORM_URL%/api/auth/register" -H "Content-Type: application/json" -d "{\"username\":\"testuser\",\"email\":\"test@example.com\",\"password\":\"test123456\",\"role\":\"streamer\"}"
```

### **PowerShell Version**
```powershell
# PowerShell with better JSON handling
$response = Invoke-RestMethod -Uri "http://localhost/api/auth/register" -Method POST -Body (@{
    username = "testuser"
    email = "test@example.com"
    password = "test123456"
    role = "streamer"
} | ConvertTo-Json) -ContentType "application/json"

$token = $response.access_token
Write-Host "Token: $token"
```

***

## ðŸŽ¯ **PRODUCTION DEPLOYMENT COMMANDS**

### **Docker Health Checks**
```bash
# Check all containers
docker-compose ps

# Check logs
docker-compose logs -f nginx
docker-compose logs -f main-app
docker-compose logs -f auth-app
docker-compose logs -f stream-app
docker-compose logs -f vod-app

# Restart services
docker-compose restart nginx
docker-compose restart main-app
```

### **Database Maintenance**
```bash
# Connect to database
docker exec -it postgres-db psql -U streaming_user -d streaming_db

# Check database status
docker exec postgres-db psql -U streaming_user -d streaming_db -c "SELECT COUNT(*) FROM streams;"
docker exec postgres-db psql -U streaming_user -d streaming_db -c "SELECT COUNT(*) FROM tasks;"
docker exec postgres-db psql -U streaming_user -d streaming_db -c "SELECT COUNT(*) FROM users;"

# Backup database
docker exec postgres-db pg_dump -U streaming_user streaming_db > backup_$(date +%Y%m%d).sql
```

***

**ðŸŽ‰ This comprehensive curl command reference covers all aspects of your Enterprise Streaming Platform. Save this as `curl-commands.md` for easy reference during development and production operations!**

**ðŸš€ Your platform is now fully documented and ready for enterprise deployment!**